<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header::header-css">
    <title>设备管理</title>
</head>
<body class="hold-transition skin-blue sidebar-mini">
<div th:replace="fragments/header::header-body"/>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jszip/2.4.0/jszip.js"></script>
<div class="content-wrapper">
    <section class="content-header">
        <h1>
            设备管理
        </h1>
        <br/>
        <ol class="breadcrumb">
            <li><a href="../index"><i class="fa fa-dashboard"></i>首页</a></li>
            <li class="active">设备管理</li>
        </ol>
    </section>


    <div class="container-fluid">

        <div class="container-fluid">
            <div id="fieldlist" style="background-color:#EDF0F4">
                <label>场地:</label> <input id="place"/> <!--下拉框-->
                <label>设备:</label> <input id="device" class="k-input k-textbox"/> <!--下拉框-->
                <button class="k-button  k-primary" onclick="grid()">查询</button>
            </div>

            <div id="grid">
                <!-- <button>导出Excel</button>-->
                <div><span id="toolbar"></span><span id="toolbar1"></span></div>



                <div id="window3" style="display: none">
                    <input name="file" id="files" type="file">
                    <!--<button id="box_relative" type="submit" class="k-button k-primary" >导入</button>-->
                </div>
                <div id="window" style="display: none">
                    <div id="grids">
                    </div>


                </div>


                <script id="template" type="text/x-kendo-template">
                    <a class="k-button" onclick="getExcel1()">导出Excel</a>
                </script>
                <script id="template1" type="text/x-kendo-template">
                    <a class="k-button" onclick="getModel1()">导出模板</a>
                </script>
                <script id="template2" type="text/x-kendo-template">
                    <a class="k-button" onclick="inExcel()">导入设备</a>
                </script>

                <script id="popup_editor" type="text/x-kendo-template">
                    <div class="k-edit-label"><label for="mcSn"><span style="color:red;">* </span>按摩椅编号</label></div>
                    <div>
                        <div data-container-for="mcSn" class="k-edit-field"><input type="text" class="k-input k-textbox"
                                                                                   name="mcSn" required="required"
                                                                                   data-required-msg="按摩椅编号为必填项！"
                                                                                   data-bind="value:mcSn"></div>
                    </div>

                    <div class="k-edit-label"><label for="loraId"><span style="color:red;">* </span>模块编号</label></div>
                    <div data-container-for="loraId" class="k-edit-field"><input type="text" class="k-input k-textbox"
                                                                                 name="loraId" required="required"
                                                                                 data-required-msg="模块编号为必填项！"
                                                                                 data-bind="value:loraId"></div>

                    <div class="k-edit-label"><label for="placeId"><span style="color:red;">* </span>所属场地</label></div>
                    <div data-container-for="placeId" class="k-edit-field">
                        <input id="placeId" data-role="combobox" data-bind="value:placeId" required="required"
                               data-required-msg="所属场地为必填项！">
                    </div>

                    <div class="k-edit-label"><label for="deviceModelEntity"><span
                            style="color:red;">* </span>所属型号</label></div>
                    <div data-container-for="deviceModelEntity" class="k-edit-field">
                        <input id="deviceModelEntity" data-role="combobox" data-bind="value:deviceModelEntity"
                               required="required" data-required-msg="所属型号为必填项！">
                    </div>

                    <div class="k-edit-label"><label for="supplierEntity"><span style="color:red;">* </span>供应商</label>
                    </div>
                    <div data-container-for="supplierEntity" class="k-edit-field">
                        <input id="supplierEntity" data-role="combobox" data-bind="value:supplierEntity"
                               required="required" data-required-msg="供应商为必填项！">
                    </div>

                    <div class="k-edit-label"><label for="gatewayEntity"><span style="color:red;">* </span>所属网关</label>
                    </div>
                    <div data-container-for="gatewayEntity" class="k-edit-field">
                        <input id="gatewayEntity" data-role="combobox" data-bind="value:gatewayEntity"
                               required="required" data-required-msg="所属网关为必填项！">
                    </div>

                    <div class="k-edit-label"><label for="note">备注信息</label></div>
                    <div data-container-for="note" class="k-edit-field"><input type="text" class="k-input k-textbox"
                                                                               name="note" data-bind="value:note"></div>
                </script>


                <script>
                    /*<![CDATA[*/
                    $(function () {


                        $("#place").kendoComboBox({
                            autoBind: false,
                            placeholder: "请选择...",
                            dataTextField: "name",
                            dataValueField: "id",
                            filter: "contains",
                            suggest: true,
                            dataSource: {
                                transport: {
                                    read: {
                                        type: "get",
                                        url: "../place/findAllPlaceFirst",
                                        dataType: "json",
                                        contentType: "application/json",
                                        headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                                    }
                                }
                            }
                        });

                        // grid();
                        // loadUserList(placeId, deviceId);
                    });

                    //初始化表格数据
                    function loadUserList(placeId, deviceId) {

                        var dataSource = new kendo.data.DataSource({
                            transport: {
                                read: {
                                    // url: "./getAllDevice"
                                    url: "../place/findDeviceByPlace?placeId=" + placeId + "&deviceId=" + deviceId
                                },
                                create: {
                                    url: "./insertDevice",
                                    dataType: "json",
                                    type: "post",
                                    contentType: "application/json"
                                },
                                destroy: {
                                    url: "./deleteDevice",
                                    dataType: "json",
                                    type: "post",
                                    contentType: "application/json"
                                },
                                update: {
                                    url: "./updateDevice",
                                    dataType: "json",
                                    type: "post",
                                    contentType: "application/json"
                                },
                                parameterMap: function (options, operation) {
                                    if (operation === "destroy") {
                                        var deviceId = options.id;

                                        var list = {
                                            id: deviceId
                                        };
                                        return kendo.stringify(list);
                                    }
                                    if (operation === "create" || operation === "update") {
                                        // var maintainDateTime =options.maintainDateTime;
                                        // options.maintainDateTime=  kendo.toString(kendo.parseDate(maintainDateTime, "yyyy-MM-ddTHH:mm:sszzz"), "yyyy-MM-dd HH:mm:ss");
                                        return kendo.stringify(options);
                                    }
                                }
                            },
                            serverPaging: false,    //设定服务器来实现分页功能
                            serverFiltering: false,
                            serverSorting: false,
                            requestEnd: onRequestEnd,
                            pageSize: 10,
                            schema: {
                                model: {
                                    id: "id",
                                    fields: {
                                        id: {type: "number", editable: false},
                                        mcSn: {
                                            type: "string",
                                            validation: {
                                                required: true,
                                                required: {message: "按摩椅编号为必填项！"}
                                            }
                                        },
                                        loraId: {
                                            type: "string",
                                            validation: {
                                                required: true,
                                                required: {message: "模块编号为必填项！"}
                                            }
                                        },
                                        note: {type: "string"},
                                        placeId: {type: "number"},
                                        placeName: {type: "string"},
                                        deviceModelEntity: {
                                            defaultValue: {id: 1, name: ""},
                                            validation: {
                                                required: true,
                                                required: {message: "所属型号为必填项！"}
                                            }
                                        },
                                        supplierEntity: {
                                            defaultValue: {id: 1, supplierName: ""},
                                            validation: {
                                                required: true,
                                                required: {message: "供应商为必填项！"}
                                            }
                                        },
                                        gatewayEntity: {
                                            defaultValue: {id: 1, gatewaySn: ""},
                                            validation: {
                                                required: true,
                                                required: {message: "所属网关为必填项！"}
                                            }
                                        }
                                    }
                                },
                                data: function (response) {
                                    var list = JSON.parse(response).data;
                                    return list;
                                },
                                total:function(response){
                                    return JSON.parse(response).total;
                                }
                            }
                        });

                        //dataSource是必填属性
                        $("#grid").kendoGrid({
                            dataSource: dataSource,
                            height: 600,
                            sortable: true, //表示是否支持排序， boolean型
                            filterable: true,//filterable表示过滤，即能进行等于，不等于，包含，已开头等过滤操作，boolean型
                            groupable: true,//表格标题
                            // scrollable: {//表示是否有下拉条，boolean型(虚拟分页)
                            //     virtual: true
                            // },
                            toolbar: [{name: "create", text: "新增"},
                                {template: kendo.template($("#template").html())},
                                {template: kendo.template($("#template1").html())},
                                {template: kendo.template($("#template2").html())}

                            ],//
                            /* excel: {
                                 fileName: "设备管理.xlsx",
                                 //proxyURL: "https://demos.telerik.com/kendo-ui/service/export,1",
                                 filterable: true,
                                 allPages:true//是否导出所有页中的数据
                             },*/
                            columnMenu: true,
                            resizable: true,
                            pageable: {
                                // empty:"没有要显示的数据",
                                // //代表是否支持刷新
                                // refresh: true,
                                // //表示每页显示的记录数，默认为5,10,20
                                pageSizes: true,
                                // //表示显示的页数，5表示1,2,3,4,5
                                buttonCount: 5,
                                totalPages: true,
                                // input: true,//表示是否可以输入数字
                                refresh: true,
                                pageSize: 5,
                                pageSizes: [5, 10, 15, 20],
                                numeric: true,
                                input: true,
                                messages: {
                                    display: "显示 {0}-{1} 条，共 {2} 条",
                                    empty: "没有数据",
                                    itemsPerPage: "每页显示数量",
                                    first: "第一页",
                                    last: "最后一页",
                                    next: "下一页",
                                    previous: "上一页",
                                    page: "页",
                                    of: "共 {0}页"
                                }
                            },
                            columns: [
                                {
                                    field: "mcSn",
                                    title: "按摩椅编号",
                                    attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                                },
                                {
                                    field: "loraId",
                                    title: "模块编号",
                                    attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                                },
                                {
                                    field: "placeName",
                                    title: "所属场地",
                                    attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                                },
                                {
                                    field: "deviceModelEntity",
                                    title: "所属型号",
                                    template: "#=deviceModelEntity.name#",
                                    attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                                },
                                {
                                    field: "supplierEntity",
                                    title: "供应商",
                                    template: "#=supplierEntity.supplierName#",
                                    attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                                },
                                {
                                    field: "gatewayEntity",
                                    title: "所属网关",
                                    template: "#=gatewayEntity.gatewaySn#",
                                    attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                                },
                                {
                                    field: "note",
                                    title: "备注信息",
                                    attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                                },
                                {
                                    command: [
                                        {
                                            name: "edit", text: {edit: "编辑", cancel: "取消", update: "更新"}
                                        }, {
                                            name: "destroy", text: "删除"
                                        }],
                                    title: "操作",
                                    width: "250px"
                                }
                            ],
                            editable: {
                                mode: "popup",
                                template: kendo.template($("#popup_editor").html()),
                                window: {
                                    title: "设备管理"
                                }
                            },
                            edit: function (e) {

                                $("#placeId").kendoComboBox({
                                    autoBind: false,
                                    placeholder: "请选择...",
                                    dataTextField: "name",
                                    dataValueField: "id",
                                    value: e.model.placeId,
                                    text: e.model.placeName,
                                    filter: "contains",
                                    suggest: true,
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "get",
                                                url: "../placeMgr/allPlace",
                                                dataType: "json",
                                                contentType: "application/json",
                                                headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                                            }
                                        }
                                    }
                                });

                                $("#deviceModelEntity").kendoComboBox({
                                    autoBind: false,
                                    placeholder: "请选择...",
                                    dataTextField: "name",
                                    dataValueField: "id",
                                    value: e.model.id,
                                    filter: "contains",
                                    suggest: true,
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "get",
                                                url: "../deviceModel/all",
                                                dataType: "json",
                                                contentType: "application/json",
                                                headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                                            }
                                        }
                                    }
                                });
                                $("#supplierEntity").kendoComboBox({
                                    autoBind: false,
                                    placeholder: "请选择...",
                                    dataTextField: "supplierName",
                                    dataValueField: "id",
                                    value: e.model.id,
                                    filter: "contains",
                                    suggest: true,
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "get",
                                                url: "../supplierMgr/allSupplier",
                                                dataType: "json",
                                                contentType: "application/json",
                                                headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                                            }
                                        }
                                    }
                                });
                                $("#gatewayEntity").kendoComboBox({
                                    autoBind: false,
                                    placeholder: "请选择...",
                                    dataTextField: "gatewaySn",
                                    dataValueField: "id",
                                    value: e.model.id,
                                    filter: "contains",
                                    suggest: true,
                                    dataSource: {
                                        transport: {
                                            read: {
                                                type: "get",
                                                url: "../gatewayMgr/allGatewayList",
                                                dataType: "json",
                                                contentType: "application/json",
                                                headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                                            }
                                        }
                                    }
                                });


                            }
                        });
                    }

                    //add tooltip
                    $("#grid").kendoTooltip({
                        show: function (e) {
                            if ($.trim(this.content.text()) != "") {
                                $('[role="tooltip"]').css("visibility", "visible");
                            }
                        },
                        hide: function () {
                            $('[role="tooltip"]').css("visibility", "hidden");
                        },
                        filter: "td:nth-child(n+3)",
                        content: function (e) {
                            var element = e.target[0];
                            if (element.offsetWidth < element.scrollWidth) {
                                var text = $(e.target).text();
                                return '<div style="min-width:100px;max-width: 1000px;">' + text + '</div>';
                            } else {
                                $('[role="tooltip"]').css("visibility", "hidden");//解决鼠标一开始放在上面出现空模块
                                return "";
                            }
                        }
                    }).data("kendoTooltip");

                    function changeDate(container, options) {
                        var input = $('<input name="' + options.field + '"/>');
                        input.appendTo(container);
                        input.kendoDateTimePicker({
                            format: "{0:yyyy-MM-dd HH:mm}"
                        });
                    }

                    //（请求后触发）点击按钮更新表格,只适用于单条修改，直接修改数据库，不适用于批量修改
                    function onRequestEnd(e) {
                        if (e.type == "create") {
                            e.sender.read();       //调用read方法 重新读取表格
                        }
                        else if (e.type == "update") {
                            e.sender.read();
                        }
                        else if (e.type == "destroy") {
                            e.sender.read();
                        }

                        //更新成功后弹出提示信息
                        var response = e.response;
                        if (response) {
                            var type = e.type;
                            if (type != 'read') {
                                var status = response.status;
                                if (status == 200) {
                                    this.read();
                                }
                                else {
                                    // alert(response.msg);
                                }
                            }
                        }
                    }


                    // function statusEditor(container, options) {
                    //     var placeId = options.model.mcStatus;
                    //
                    //     var input = $('<input required name="' + options.field + '"/>');
                    //     input.appendTo(container);
                    //     input.kendoComboBox({
                    //         autoBind: true,
                    //         placeholder: "请选择...",
                    //         dataTextField: "name",
                    //         dataValueField: "id",
                    //         value: placeId,
                    //         filter: "contains",
                    //         suggest: true,
                    //         dataSource: [
                    //             {
                    //                 "id": 0,
                    //                 "name": "正常"
                    //             }, {
                    //                 "id": 1,
                    //                 "name": "维修中"
                    //             }, {
                    //                 "id": 2,
                    //                 "name": "停用"
                    //             }
                    //         ]
                    //     });
                    // }
                    //
                    //
                    // function placeEditor(container, options) {
                    //     var placeId = options.model.placeEntity.id;
                    //
                    //     var input = $('<input required name="' + options.field + '"/>');
                    //     input.appendTo(container);
                    //     input.kendoComboBox({
                    //         autoBind: false,
                    //         placeholder: "请选择...",
                    //         dataTextField: "name",
                    //         dataValueField: "id",
                    //         value: placeId,
                    //         filter: "contains",
                    //         suggest: true,
                    //         dataSource: {
                    //             transport: {
                    //                 read: {
                    //                     type: "get",
                    //                     url: "../placeMgr/allPlace",
                    //                     dataType: "json",
                    //                     contentType: "application/json",
                    //                     headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                    //                 }
                    //             }
                    //         }
                    //     });
                    // }
                    //
                    // function deviceEditor(container, options) {
                    //     var deviceId = options.model.deviceModelEntity.id;
                    //
                    //     var input = $('<input required name="' + options.field + '"/>');
                    //     input.appendTo(container);
                    //     input.kendoComboBox({
                    //         autoBind: false,
                    //         placeholder: "请选择...",
                    //         dataTextField: "name",
                    //         dataValueField: "id",
                    //         value: deviceId,
                    //         filter: "contains",
                    //         suggest: true,
                    //         dataSource: {
                    //             transport: {
                    //                 read: {
                    //                     type: "get",
                    //                     url: "../deviceModel/all",
                    //                     dataType: "json",
                    //                     contentType: "application/json",
                    //                     headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                    //                 }
                    //             }
                    //         }
                    //     });
                    // }
                    //
                    // function supplierEditor(container, options) {
                    //     var deviceId = options.model.supplierEntity.id;
                    //
                    //     var input = $('<input required name="' + options.field + '"/>');
                    //     input.appendTo(container);
                    //     input.kendoComboBox({
                    //         autoBind: false,
                    //         placeholder: "请选择...",
                    //         dataTextField: "supplierName",
                    //         dataValueField: "id",
                    //         value: deviceId,
                    //         filter: "contains",
                    //         suggest: true,
                    //         dataSource: {
                    //             transport: {
                    //                 read: {
                    //                     type: "get",
                    //                     url: "../supplierMgr/allSupplier",
                    //                     dataType: "json",
                    //                     contentType: "application/json",
                    //                     headers: {'Content-Type': 'application/x-www-form-urlencoded'}
                    //                 }
                    //             }
                    //         }
                    //     });
                    // }

                    /*]]>*/

                    //点击查询按钮
                    function grid() {
                        var placeId = $("#place").data("kendoComboBox").value();//场地id
                        var deviceId = $("#device").val();//设备id

                        if (placeId == "" && deviceId == "") {
                            alert("请选择场地或输入设备编号！");
                            return;
                        }
                        if (placeId == "") {
                            placeId = 0;
                        }
                        if (deviceId == "") {
                            deviceId = 0;
                        }
                        console.log(placeId);
                        console.log(deviceId);

                        loadUserList(placeId, deviceId);
                    }
                </script>

                <!--设置tooltip的样式-->
                <style>
                    div[role=tooltip].k-tooltip {
                        padding: 2px;
                        background: #5c9acf;
                    }

                    .k-tooltip-content {
                        padding: 4px;
                        text-align: left;
                        background: #fff;
                        color: #666;
                    }

                    .k-callout {
                        border-bottom-color: #5c9acf;
                    }
                </style>

                <!--<script type="text/x-kendo-template" id="reviseDate_template">-->
                <!--#= kendo.toString(reviseDate, "yyyy-MM-dd") #-->
                <!--</script>-->
            </div>

        </div>
    </div>
    <!-- /.container -->

    <script>
        function getExcel1() {
            //t, {name:"导出excel",click:function(){

            $.ajax({
                type: "GET",
                url: "../deviceMgr/getallDevice",

                contentType: "application/json; charset=utf-8",

                success: function () {

                    window.location = "../deviceMgr/getallDevice"

                }

            })

        }


        function getModel1() {
            //t, {name:"导出excel",click:function(){

            $.ajax({
                type: "GET",
                url: "../deviceMgr/getmodel",

                contentType: "application/json; charset=utf-8",

                success: function () {

                    window.location = "../deviceMgr/getmodel"

                }

            })

        }

        function inExcel() {
            //t, {name:"导出excel",click:function(){

            importexcel()

        }


        $(document).ready(function () {
            //  $("#files").kendoUpload();
            //window.location="../priceTest1";

            $("#files").kendoUpload({
                async: {
                    saveUrl: "../deviceMgr/setExcel",
                    autoUpload: true

                }, localization: {     //设置上传按钮名称
                    select: "上传"
                },
                success: function (e) {
                    console.log(e.response);
////////
                    var my = $("#window3");
                    my.data("kendoWindow").close();

                    var myWindow = $("#window"),
                        undo = $("#undo");


                    function onClose() {
                        undo.fadeIn();
                        window.location = "./turnToDeviceMgr";
                    }

                    myWindow.kendoWindow({
                        width: "600px",
                        title: "导入结果",
                        visible: false,
                        actions: [
                            "Pin",
                            "Minimize",
                            "Maximize",
                            "Close"
                        ],
                        close: onClose
                    }).data("kendoWindow").center().open();


//写grid

                    $("#grids").kendoGrid({
                        dataSource: e.response,
                        height: 600,
                        sortable: true, //表示是否支持排序， boolean型
                        filterable: true,//filterable表示过滤，即能进行等于，不等于，包含，已开头等过滤操作，boolean型
                        groupable: true,//表格标题
                        // scrollable: {//表示是否有下拉条，boolean型(虚拟分页)
                        //     virtual: true
                        // },
                        toolbar: [{name: "excel", text: "导出Excel"},

                        ],
                        excel: {
                            fileName: "导入结果.xlsx",
                            allPages: true
                        },//
                        /* excel: {
                             fileName: "设备管理.xlsx",
                             //proxyURL: "https://demos.telerik.com/kendo-ui/service/export,1",
                             filterable: true,
                             allPages:true//是否导出所有页中的数据
                         },*/
                        columnMenu: true,
                        resizable: true,
                        pageable: {
                            // empty:"没有要显示的数据",
                            // //代表是否支持刷新
                            // refresh: true,
                            // //表示每页显示的记录数，默认为5,10,20
                            pageSizes: true,
                            // //表示显示的页数，5表示1,2,3,4,5
                            buttonCount: 5,
                            totalPages: true,
                            // input: true,//表示是否可以输入数字
                            refresh: true,
                            pageSize: 10,
                            pageSizes: [5, 10, 15, 20],
                            numeric: true,
                            input: true,
                            messages: {
                                display: "显示 {0}-{1} 条，共 {2} 条",
                                empty: "没有数据",
                                itemsPerPage: "每页显示数量",
                                first: "第一页",
                                last: "最后一页",
                                next: "下一页",
                                previous: "上一页",
                                page: "页",
                                of: "共 {0}页"
                            }
                        },
                        columns: [
                            {
                                field: "name",
                                title: "地区名称",
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            {
                                field: "weidu",
                                title: "坐标纬度",
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            {
                                field: "jingdu",
                                title: "坐标精度",
                                // template:"#=placeEntity.name#",
                                //editor:placeEditor,
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            {
                                field: "type",
                                title: "型号",
                                //  template:"#=deviceModelEntity.name#",
                                //   editor:deviceEditor,
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            {
                                field: "sn",
                                title: "设备编号",
                                // template:"#=supplierEntity.supplierName#",
                                //  editor:supplierEditor,
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            {
                                field: "deviceType",
                                title: "设备类型",
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            {
                                field: "beizhu",
                                title: "备注",
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            {
                                field: "gatSn",
                                title: "网关",
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },

                            {
                                field: "msg",
                                title: "导入结果",
                                attributes: {style: "white-space:nowrap;text-overflow:ellipsis;"}
                            },
                            /*{
                                command: [
                                    {
                                        name: "edit", text: {edit: "编辑", cancel: "取消", update: "更新"}
                                    }, {
                                        name: "destroy", text: "删除"
                                    }],
                                title: "操作",
                                width: "250px"
                            }*/
                        ],
                        editable: {
                            mode: "popup",
                            window: {
                                title: "设备管理"
                            }
                        }
                    });


                }

            })


        });

        function importexcel() {

            $(document).ready(function () {
                var myWindow = $("#window3"),
                    undo = $("#undo");

                undo.click(function () {
                    myWindow.data("kendoWindow").open();
                    undo.fadeOut();

                    $(document).ready(function () {
                        $("#files").kendoUpload({
                            async: {
                                saveUrl: "save",
                                removeUrl: "remove",
                                autoUpload: true
                            }
                        });
                    });


                });

                function onClose() {
                    undo.fadeIn();
                    //  window.location;
                }

                myWindow.kendoWindow({
                    width: "600px",
                    title: "导入填写好的Excel",
                    visible: false,
                    actions: [
                        "Pin",
                        "Minimize",
                        "Maximize",
                        "Close"
                    ],
                    close: onClose
                }).data("kendoWindow").center().open();
            });


        }


        /* function getError(e) {
             //t, {name:"导出excel",click:function(){
             e.response
           var  list =  new Array();
             list.push(e.response)
             $.ajax({
                 type: "GET",
                 url: "./deviceMgr/getExcelError?result="+list,

                 contentType: "application/json; charset=utf-8",

                 success:function () {

                     window.location="./deviceMgr/getExcelError?result="+list

                 }

             })

         }*/


    </script>
    <style>
        #toolbar {

        }
    </style>

    <!--<footer th:replace="fragments/footer::footer"/>-->

    <aside th:replace="fragments/menu"/>
</body>
</html>